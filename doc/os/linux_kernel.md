# Linux 内核

## 1. 概念

什么是操作系统？操作系统是计算机包含的最基本的一组程序。

操作系统需要提供两个主要的功能：
1. 与硬件层交互的功能
2. 为应用程序提供运行的环境

### 1.1. 多用户系统

多用户系统需要具备的特性：
* 一个验证机制验证用户的身份
* 一个保护机制，可以保护有问题的程序阻塞其他应用
* 可以从恶意用户手中保护其他用户的信息和活动
* 限制每个用户对资源的访问数量

## 2. 进程

## 3. 文件

内核中的文件是一堆结构化的信息，内核并不理解文件的内容。

> 每个进程都有一个目录是它的工作目录，这是这个进程的执行上下文。进程需要指定一个文件，使用一个路径来表示，如果这个路径是以 / 开始，则它是绝对路径，如果路径不以 / 开始，那么它就是一个相对路径，相对于进程的工作目录。

### 3.1. hard link & soft link

创建 hard link

```
ln p1 p2
```

hard link 的限制
* 无法给目录创建一个 hard link
* 无法跨越文件系统创建 hard link

创建 soft link

```
ln -s p1 p2
```

### 3.2. 文件类型

* 普通文件
* 目录
* 符号链接
* Block-oriented device file
* Character-oriented device file
* Pipe and named pipe
* Socket

前三个是构成操作系统的基本组成部分，device file 使用来操作 I/O 设备，pipe 和 socket 则是用来进程间通信。


### 3.3. 文件描述符和 inode

文件的信息都存储在 inode 里面。

文件描述符表示了一个在进程和打开的文件之间的一个交互对象。同一个文件可以在同一个进程里面以不同的文件描述符打开。

### 3.4. 访问权限

所有的用户都会被三类

* 文件拥有者
* 属于同一个组的用户
* 其他用户

权限则被分为三类：读，写，执行。

### 3.5. 文件的操作

Regular File 一般可以顺序和随机的寻址，device file 和 named pipe 一般是顺序的寻址。

可以使用 read 和 write 接口从当前位置读取。lseek 可以改变当前的位置。

重命名可以用 rename，删除文件使用 unlink。